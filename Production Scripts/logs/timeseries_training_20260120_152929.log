2026-01-20 15:29:29,306 - __main__ - INFO - Logging to: C:\Users\Admin\Desktop\DonHang\Production Scripts\logs\timeseries_training_20260120_152929.log
2026-01-20 15:29:29,307 - __main__ - INFO - 
================================================================================
2026-01-20 15:29:29,307 - __main__ - INFO - TIME-SERIES SALES FORECASTING - PRODUCTION TRAINING
2026-01-20 15:29:29,307 - __main__ - INFO - ================================================================================
2026-01-20 15:29:29,307 - __main__ - INFO - Environment: development
2026-01-20 15:29:29,309 - __main__ - INFO - Device: cpu
2026-01-20 15:29:29,309 - __main__ - INFO - Batch size: 64
2026-01-20 15:29:29,309 - __main__ - INFO - Epochs: 20
2026-01-20 15:29:29,309 - __main__ - INFO - ================================================================================

2026-01-20 15:29:29,309 - __main__ - INFO - 
[1/6] Loading raw data...
2026-01-20 15:30:07,476 - __main__ - INFO - ‚úÖ Loaded 2,371,571 rows √ó 90 columns
2026-01-20 15:30:07,477 - __main__ - INFO - 
[2/6] Mapping columns...
2026-01-20 15:30:08,696 - __main__ - INFO - ‚úÖ Using 22 columns
2026-01-20 15:30:08,697 - __main__ - INFO - 
[3/6] Cleaning numeric columns...
2026-01-20 15:30:09,734 - __main__ - INFO -   S·ªê L∆Ø·ª¢NG ƒê∆†N B√ÅN: Total = 20,043,704
2026-01-20 15:30:10,410 - __main__ - INFO -   ƒê∆†N GI√Å ƒê∆†N B√ÅN: Total = 173,046,653,548
2026-01-20 15:30:11,072 - __main__ - INFO -   T·ªîNG TI·ªÄN ƒê∆†N B√ÅN: Total = 9,724,653,321,869
2026-01-20 15:30:11,765 - __main__ - INFO -   CHI·∫æT KH·∫§U ƒê∆†N B√ÅN: Total = 914,661,014,532
2026-01-20 15:30:12,450 - __main__ - INFO -   TH√ÄNH TI·ªÄN ƒê∆†N B√ÅN: Total = 8,657,115,433,981
2026-01-20 15:30:12,450 - __main__ - INFO - 
[4/6] Time-based split...
2026-01-20 15:30:12,451 - __main__ - INFO - 
================================================================================
2026-01-20 15:30:12,451 - __main__ - INFO - TIME-BASED DATA SPLIT (Anti-Leakage)
2026-01-20 15:30:12,451 - __main__ - INFO - ================================================================================
2026-01-20 15:30:12,748 - __main__ - INFO - Date range: 2025-01-01 to 2025-12-31
2026-01-20 15:30:12,749 - __main__ - INFO - Total days: 364
2026-01-20 15:30:13,649 - __main__ - INFO - 
üìÖ TRAIN: 2025-01-01 to 2025-09-12
2026-01-20 15:30:13,649 - __main__ - INFO -    Rows: 1,575,582 (68.3%)
2026-01-20 15:30:13,695 - __main__ - INFO -    Unique customers: 45,486
2026-01-20 15:30:13,695 - __main__ - INFO - 
üìÖ VAL: 2025-09-13 to 2025-11-05
2026-01-20 15:30:13,696 - __main__ - INFO -    Rows: 372,225 (16.1%)
2026-01-20 15:30:13,708 - __main__ - INFO -    Unique customers: 29,536
2026-01-20 15:30:13,708 - __main__ - INFO - 
üìÖ TEST: 2025-11-06 to 2025-12-31
2026-01-20 15:30:13,708 - __main__ - INFO -    Rows: 360,687 (15.6%)
2026-01-20 15:30:13,720 - __main__ - INFO -    Unique customers: 33,975
2026-01-20 15:30:13,724 - __main__ - INFO - 
‚úÖ Time-based split validated - NO DATA LEAKAGE
2026-01-20 15:30:13,725 - __main__ - INFO - ================================================================================

2026-01-20 15:30:13,886 - __main__ - INFO - 
[5/6] Feature engineering...
2026-01-20 15:30:13,887 - __main__ - INFO -   Processing train set...
2026-01-20 15:30:14,000 - features - INFO - Running feature engineering pipeline...
2026-01-20 15:30:14,000 - features - INFO - Cleaning text columns...
2026-01-20 15:30:16,239 - features - INFO - Cleaning numeric columns...
2026-01-20 15:30:20,372 - features - INFO - Creating temporal features...
2026-01-20 15:30:20,875 - features - INFO - Creating product features...
2026-01-20 15:30:21,272 - features - INFO - Creating customer features...
2026-01-20 15:30:21,375 - features - INFO - Creating route and geography features...
2026-01-20 15:30:21,773 - features - INFO - Geocoding 42,563 unique addresses...
2026-01-20 15:30:25,229 - features - INFO - Creating aggregated features...
2026-01-20 15:30:28,196 - features - INFO - Creating temporal comparison features...
2026-01-20 15:36:35,649 - features - INFO - Segmenting customers into 5 clusters...
2026-01-20 15:36:36,329 - features - INFO - Encoding categorical variables...
2026-01-20 15:36:37,112 - features - INFO -   LO·∫†I S·∫¢N PH·∫®M: 3 classes
2026-01-20 15:36:37,819 - features - INFO -   NGU·ªíN ƒê∆†N: 3 classes
2026-01-20 15:36:38,792 - features - INFO -   product_series: 36 classes
2026-01-20 15:36:39,803 - features - INFO -   product_family: 29 classes
2026-01-20 15:36:40,519 - features - INFO -   price_tier: 6 classes
2026-01-20 15:36:41,076 - features - INFO -   province: 43 classes
2026-01-20 15:36:41,616 - features - INFO -   district: 93 classes
2026-01-20 15:36:42,253 - features - INFO -   route_code: 324 classes
2026-01-20 15:36:42,256 - features - INFO - Feature engineering complete!
2026-01-20 15:36:42,256 - features - INFO - Preparing customer sequences...
2026-01-20 15:37:53,891 - __main__ - INFO -   ‚úÖ Train sequences: 45,486
2026-01-20 15:37:54,151 - __main__ - INFO -   Processing val set...
2026-01-20 15:37:54,189 - features - INFO - Running feature engineering pipeline...
2026-01-20 15:37:54,190 - features - INFO - Cleaning text columns...
2026-01-20 15:37:54,876 - features - INFO - Cleaning numeric columns...
2026-01-20 15:37:56,309 - features - INFO - Creating temporal features...
2026-01-20 15:37:56,482 - features - INFO - Creating product features...
2026-01-20 15:37:56,611 - features - INFO - Creating customer features...
2026-01-20 15:37:56,648 - features - INFO - Creating route and geography features...
2026-01-20 15:37:56,777 - features - INFO - Geocoding 28,151 unique addresses...
2026-01-20 15:37:58,130 - features - INFO - Creating aggregated features...
2026-01-20 15:37:58,976 - features - INFO - Creating temporal comparison features...
2026-01-20 15:42:46,838 - features - INFO - Segmenting customers into 5 clusters...
2026-01-20 15:42:47,016 - features - INFO - Encoding categorical variables...
2026-01-20 15:42:47,730 - features - WARNING -   ‚ö†Ô∏è product_series: 6638 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:42:47,731 - features - WARNING -      New values: ['DHM5', 'STIC', 'DHM1', 'DHM9', 'DDNX']
2026-01-20 15:42:48,114 - features - WARNING -   ‚ö†Ô∏è product_family: 222 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:42:48,114 - features - WARNING -      New values: ['DD']
2026-01-20 15:42:49,149 - features - WARNING -   ‚ö†Ô∏è route_code: 1486 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:42:49,149 - features - WARNING -      New values: ['R7500404 - Tuy·∫øn Nguy·ªÖn Nh·∫≠t Thi√™n', 'R7900306 - Tuy·∫øn B·∫£o Th∆∞∆°ng', 'R9400105 - Tuy·∫øn 05', 'RSTMN01021 - Tuy·∫øn Nguy·ªÖn Ch√≠ T√¢m', 'RSTMN0301 - Tuy·∫øn Ch√≠ T√¢m']
2026-01-20 15:42:49,276 - features - INFO - Feature engineering complete!
2026-01-20 15:42:49,276 - features - INFO - Preparing customer sequences...
2026-01-20 15:43:31,856 - __main__ - INFO -   ‚úÖ Val sequences: 29,536
2026-01-20 15:43:32,177 - __main__ - INFO -   Processing test set...
2026-01-20 15:43:32,216 - features - INFO - Running feature engineering pipeline...
2026-01-20 15:43:32,217 - features - INFO - Cleaning text columns...
2026-01-20 15:43:32,910 - features - INFO - Cleaning numeric columns...
2026-01-20 15:43:34,351 - features - INFO - Creating temporal features...
2026-01-20 15:43:34,532 - features - INFO - Creating product features...
2026-01-20 15:43:34,677 - features - INFO - Creating customer features...
2026-01-20 15:43:34,704 - features - INFO - Creating route and geography features...
2026-01-20 15:43:34,875 - features - INFO - Geocoding 32,233 unique addresses...
2026-01-20 15:43:36,364 - features - INFO - Creating aggregated features...
2026-01-20 15:43:37,274 - features - INFO - Creating temporal comparison features...
2026-01-20 15:47:40,718 - features - INFO - Segmenting customers into 5 clusters...
2026-01-20 15:47:40,839 - features - INFO - Encoding categorical variables...
2026-01-20 15:47:41,213 - features - WARNING -   ‚ö†Ô∏è product_series: 6707 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:47:41,214 - features - WARNING -      New values: ['KMDH', 'STIC', 'DHM5', 'DHM1', 'DHM9']
2026-01-20 15:47:41,399 - features - WARNING -   ‚ö†Ô∏è product_family: 2695 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:47:41,400 - features - WARNING -      New values: ['DD']
2026-01-20 15:47:41,943 - features - WARNING -   ‚ö†Ô∏è route_code: 5814 unknown values ‚Üí __UNKNOWN__
2026-01-20 15:47:41,944 - features - WARNING -      New values: ['R4800112 - Tuy·∫øn 12', 'R5400106 - Tuy·∫øn 06', 'R6400108 - Tuy·∫øn 08', 'R7500404 - Tuy·∫øn Nguy·ªÖn Nh·∫≠t Thi√™n', 'R7900306 - Tuy·∫øn B·∫£o Th∆∞∆°ng']
2026-01-20 15:47:42,042 - features - INFO - Feature engineering complete!
2026-01-20 15:47:42,043 - features - INFO - Preparing customer sequences...
2026-01-20 15:48:14,778 - __main__ - INFO -   ‚úÖ Test sequences: 33,975
2026-01-20 15:48:15,056 - __main__ - INFO - 
[6/6] Creating product mapping...
2026-01-20 15:48:15,088 - __main__ - INFO - ‚úÖ Total unique products: 246
2026-01-20 15:48:15,088 - __main__ - INFO - 
Creating time-series datasets...
2026-01-20 15:48:18,402 - __main__ - INFO - ‚úÖ Dataloaders ready:
2026-01-20 15:48:18,402 - __main__ - INFO -   Train batches: 711
2026-01-20 15:48:18,402 - __main__ - INFO -   Val batches: 462
2026-01-20 15:48:18,403 - __main__ - INFO -   Test batches: 531
2026-01-20 15:48:18,403 - __main__ - INFO - 
Creating time-series model...
2026-01-20 15:48:18,428 - __main__ - INFO - 
‚úÖ Data preparation complete!
2026-01-20 15:48:18,429 - __main__ - INFO - Next step: Implement training loop with time-aware loss
2026-01-20 15:48:18,429 - __main__ - INFO - 
Key improvements:
2026-01-20 15:48:18,429 - __main__ - INFO -   1. ‚úÖ Time-based split (no data leakage)
2026-01-20 15:48:18,429 - __main__ - INFO -   2. ‚úÖ Numeric columns properly cleaned
2026-01-20 15:48:18,429 - __main__ - INFO -   3. ‚úÖ Time-aware model architecture
2026-01-20 15:48:18,429 - __main__ - INFO -   4. ‚è≥ Need to implement training loop
2026-01-20 15:48:18,435 - __main__ - INFO - 
üíæ Checkpoint saved: C:\Users\Admin\Desktop\DonHang\Production Scripts\models\timeseries_checkpoint.pth
